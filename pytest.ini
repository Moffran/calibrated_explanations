[pytest]
minversion = 6.0
addopts = -q --cov=src/calibrated_explanations --cov-config=.coveragerc --cov-report=term-missing --cov-report=xml --cov-fail-under=85 --ignore=tests/unit/viz/test_matplotlib_adapter_additional.py --ignore=tests/unit/viz/test_matplotlib_adapter_regression_primitives.py --ignore=tests/unit/viz/test_matplotlib_adapter_render.py --ignore=tests/unit/viz/test_plot_parity_adapter.py --ignore=tests/unit/viz/test_plotspec_mvp.py --ignore=tests/unit/viz/test_plotspec_render_behavior.py --ignore=tests/unit/viz/test_probabilistic_builder_and_adapter_primitives.py --ignore=tests/unit/viz/test_matplotlib_adapter_primitives.py
testpaths = tests
markers =
    slow: marks tests as slow (can be skipped in FAST_TESTS)
    viz: marks visualization tests (optional extras)
    viz_render: marks tests that call matplotlib_adapter.render() (may fail with coverage due to lazy loading conflicts per ADR-023)
filterwarnings =
    error::DeprecationWarning
    error::PendingDeprecationWarning
    error::FutureWarning

    # Reduce noise from common third-party user warnings (matplotlib/numpy).
    # These are suppressed temporarily while we address real deprecations.
    ignore::UserWarning
    # Intentional deprecation emitted by the library during transition - allow in tests
    ignore:The legacy module 'calibrated_explanations.core' is deprecated; import from the 'calibrated_explanations.core' package instead.:DeprecationWarning
    # fontTools py23 module deprecation - third-party library issue
    ignore:The py23 module has been deprecated:DeprecationWarning:fontTools.misc.py23
